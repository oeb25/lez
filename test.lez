uniforms {
	tex: sampler2D,
    scale: float,
}

fun sampleTex(coords: vec2): vec3 {
    let color = vec3(texture(tex, coords));
    if scale != 2.0 {
        color
    } else {
        let brightness = dot(color, vec3(0.2126, 0.7152, 0.0722));
        if brightness > 0.04 {
            color
        } else {
            vec3(0)
        };
    };
}

struct VSOut {
    TexCoords: vec2,
}

fun vert(): VSOut {
    let out: VSOut;

    out
}

fun frag(TexCoords: vec2): vec3 {
    let tex_offset = 1.0 / textureSize(tex, 0);
    
    let c = sampleTex(TexCoords);
    
    let horizontal = mod(scale, 2) == 0;
    
    for i in 0..5 {
        let move_by = if horizontal {
            vec2(tex_offset.x * i, 0)
        } else {
            vec2(0, tex_offset.y * i)
        };
        c += sampleTex(TexCoords + move_by);
        c += sampleTex(TexCoords - move_by);
    };

    c
}
